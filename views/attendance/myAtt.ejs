<% layout("layout/boilerplate") %>

<div class="container">
    <h1>Weekly Attendance Information</h1>

    <% if (!startDate || !endDate || !daysInWeek) { %>
        <p>Please provide valid start date, end date, and days in a week.</p>
    <% } else { %>
        <table class="table">
            <thead>
                <tr>
                    <th>Week</th>
                    <% daysInWeek.forEach(day => { %>
                        <th><%= day %></th>
                    <% }); %>
                </tr>
            </thead>
            <tbody>
                <% for(let i = 0; i < numberOfWeeks; i++) { %>
                    <tr>
                        <td>Week <%= i + 1 %></td>
                        <% daysInWeek.forEach(day => { %>
                            <td><%= formatDate(getDateForWeekDay(startDate, i, day)) %></td>
                        <% }); %>
                    </tr>
                <% } %>
            </tbody>
        </table>
    <% } %>
</div>

<script>
    function getDateForWeekDay(startDate, weekIndex, day) {
        const date = new Date(startDate);
        date.setDate(date.getDate() + (weekIndex * 7) + day);
        return date;
    }

    function formatDate(date) {
        const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
        return date.toLocaleDateString(undefined, options);
    }
</script>
